<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>in_T19_MLR.knit</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Full Tutorial List</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    R-BASICS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="CH1_BASICS.html#ch1">1 Installing/Accessing R</a>
    </li>
    <li>
      <a href="CH1_BASICS.html#ch2">2 Changing Settings</a>
    </li>
    <li>
      <a href="CH1_BASICS.html#ch3">3 Console/coding basics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    STARTING EACH LAB
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="CH2_EACHLAB.html#ch4">4. Projects</a>
    </li>
    <li>
      <a href="CH2_EACHLAB.html#ch5">5. Packages</a>
    </li>
    <li>
      <a href="CH2_EACHLAB.html#ch6">6. R-Markdown</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    EXPLORING DATA
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_T07_ReadingInData.html">7. Reading in data</a>
    </li>
    <li>
      <a href="in_T08_Wrangling.html">8. Summaries</a>
    </li>
    <li>
      <a href="in_T08_Wrangling.html">9. Filtering</a>
    </li>
    <li>
      <a href="in_T08_Wrangling.html">10. Missing data</a>
    </li>
    <li>
      <a href="in_T11_Plots.html">11. Plots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    STATISTICAL-ANALYSIS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_T12_NormalDistributionsTTests.html">12. Normal/T-Dist/Tests</a>
    </li>
    <li>
      <a href="in_T13_Correlation.html">13 Correlation</a>
    </li>
    <li>
      <a href="in_T14_Regression.html">14. Simple Linear Regression</a>
    </li>
    <li>
      <a href="in_T15_Diagnostics.html">15. Model Diagnostics</a>
    </li>
    <li>
      <a href="in_T16_Outliers.html">16. Outliers</a>
    </li>
    <li>
      <a href="in_T17_ConfPred.html">17. Confidence &amp; Prediction</a>
    </li>
    <li>
      <a href="in_T18_Transformations.html">18. Transformations</a>
    </li>
    <li>
      <a href="in_T19_MLR.html">19. Multiple Linear Regression</a>
    </li>
    <li>
      <a href="in_T20_GLM.html">20. General Linear Regression</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="basic-model-comparisons" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Basic model
comparisons</h1>
<p>You are now being asked to assess two (or more) models and decide
“which is best”. Here are some metrics we could use to compare
models.</p>
<div id="is-the-model-appropriate-line-influential-outliers"
class="section level3 unnumbered">
<h3 class="unnumbered">Is the model appropriate? LINE &amp; influential
outliers</h3>
<p>There is no point comparing a model if one (or both) of them is not
valid! So before carrying on, it’s important to assess whether each of
your models is valid in its own right. See the LINE tutorial for
more.</p>
<ol style="list-style-type: decimal">
<li><u><strong>Linearity</strong></u> <strong>- COULD A CURVE FIT BETTER
THAN A LINE?</strong>
<ul>
<li><em>Assessed by visual inspection of the scatterplot and residual
plot.</em> <br><br></li>
<li>If broken, apply a transformation to the RESPONSE and see if your
new model does better <br><br></li>
</ul></li>
<li><u><strong>Independence</strong></u> <strong>- To be best of your
knowledge, Is your sample representative of the overall
population?</strong> Are all the points independent of each other? Or do
you have a “basketball team in your sample” situation (if you are trying
to assess student height).
<ul>
<li><em>Assessed by visually looking for non-randomness
(clusters/patterns) in your data and residual plot.</em> <br><br></li>
</ul></li>
<li><u><strong>Normality of residuals</strong></u> <strong>- Are your
residuals normally distributed around the line of best fit? Or are they
skewed in some way?</strong>
<ul>
<li><em>Assessed by the qq-plot and normality tests</em></li>
<li>If broken apply a transformation to a/the PREDICTOR and see if your
new model does better<br><br></li>
</ul></li>
<li><u><strong>Equal variance of residuals</strong></u> <strong>- no
matter what your predictor/response - are your points around the same
distance from the line? Or do you see “fanning out” / “bow-tie
shapes”</strong>
<ul>
<li><em>Assessed by visual inspection of residual plot and
heteroskadisity F-test.</em></li>
<li>If broken apply a transformation to a/the PREDICTOR and see if your
new model does better <br><br></li>
</ul></li>
</ol>
<p><br><br></p>
</div>
<div id="coefficient-of-determination-r2"
class="section level3 unnumbered">
<h3 class="unnumbered">Coefficient of Determination <span
class="math inline">\(R^2\)</span></h3>
<p>We could look first at the coefficient of variation for each model in
the model summary. e.g. which model explains more variation in your
response variable.</p>
<p><br></p>
<div id="standard-r2" class="section level4 unnumbered">
<h4 class="unnumbered">Standard <span
class="math inline">\(R^2\)</span></h4>
<p>The amount of variability explained by your model. e.g. 90% of the
variability in building height can be explained by the number of floors
it has.</p>
</div>
<div id="adjusted-r2" class="section level4 unnumbered">
<h4 class="unnumbered">Adjusted <span
class="math inline">\(R^2\)</span></h4>
<p>This is more appropriate for multiple regression as it takes into
account the number of predictors to prevent overfitting. Read this! <a
href="https://online.stat.psu.edu/stat501/lesson/10/10.3"
class="uri">https://online.stat.psu.edu/stat501/lesson/10/10.3</a> and
see the lecture on transformations/AIC.</p>
</div>
<div id="where-to-find-them" class="section level4 unnumbered">
<h4 class="unnumbered">Where to find them</h4>
<p>The easiest way is in the olsrr summary. Look at the statistics at
the top.</p>
<pre class="r"><code>data(&quot;iris&quot;)
model &lt;- lm(Sepal.Length~Sepal.Width,data=iris)
olsrr::ols_regress(model)</code></pre>
<pre><code>##                          Model Summary                           
## ----------------------------------------------------------------
## R                        0.118       RMSE                 0.820 
## R-Squared                0.014       MSE                  0.672 
## Adj. R-Squared           0.007       Coef. Var           14.120 
## Pred R-Squared          -0.011       AIC                371.992 
## MAE                      0.675       SBC                381.024 
## ----------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
##  AIC: Akaike Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
## 
##                                ANOVA                                
## -------------------------------------------------------------------
##                Sum of                                              
##               Squares         DF    Mean Square      F        Sig. 
## -------------------------------------------------------------------
## Regression      1.412          1          1.412    2.074    0.1519 
## Residual      100.756        148          0.681                    
## Total         102.168        149                                   
## -------------------------------------------------------------------
## 
##                                   Parameter Estimates                                   
## ---------------------------------------------------------------------------------------
##       model      Beta    Std. Error    Std. Beta      t        Sig      lower    upper 
## ---------------------------------------------------------------------------------------
## (Intercept)     6.526         0.479                 13.628    0.000     5.580    7.473 
## Sepal.Width    -0.223         0.155       -0.118    -1.440    0.152    -0.530    0.083 
## ---------------------------------------------------------------------------------------</code></pre>
<p><br><br></p>
</div>
</div>
<div id="mse-rmse-root-mean-squared-error"
class="section level3 unnumbered">
<h3 class="unnumbered">MSE, RMSE, (root) mean squared error</h3>
<p>This is the raw variability around the regression line in units of Y.
You can see this as the residual mean squares in ANOVA, or at the
summary at the top.</p>
<div id="rmse" class="section level4" number="1.0.0.1">
<h4><span class="header-section-number">1.0.0.1</span> RMSE</h4>
<p>Root mean squared error. Same thing but the square root (e.g. closer
to the standard deviation)</p>
<p><br><br></p>
</div>
</div>
<div id="information-criteria-aic" class="section level3 unnumbered">
<h3 class="unnumbered">Information criteria: AIC</h3>
<p>(read more here: <a
href="https://online.stat.psu.edu/stat501/lesson/10/10.5"
class="uri">https://online.stat.psu.edu/stat501/lesson/10/10.5</a>).</p>
<p>To compare regression models, some statistical software may also give
values of statistics referred to as <strong>information
criterion</strong> statistics. For regression models, these statistics
combine information about the SSE, the number of parameters in the
model, and the sample size. A low value, compared to values for other
possible models, is good. Some data analysts feel that these statistics
give a more realistic comparison of models than the 𝐶𝑝 statistic because
𝐶𝑝tends to make models seem more different than they actually are.</p>
<p>This is a non parametric test that takes into account the number of
predictors and the amount of data, so is often more robust to bad linear
fits than <span class="math inline">\(R^2\)</span> (which needs LINE to
be true)</p>
<p>Three information criteria that we present are called
<strong>Akaike’s Information Criterion</strong> (<strong>AIC</strong>),
the <strong>Bayesian Information Criterion</strong>
(<strong>BIC</strong>) (which is sometimes called <strong>Schwartz’s
Bayesian Criterion</strong> (<strong>SBC</strong>)), and
<strong>Amemiya’s Prediction Criterion</strong> (<strong>APC</strong>).
The respective formulas are as follows:</p>
<p><img src="images/Screenshot%202024-04-24%20at%203.17.31%20PM.png"
style="width:70.0%" /></p>
<p>In the formulas, <em>n</em> = sample size and <em>p</em> = number of
regression coefficients in the model being evaluated (including the
intercept). Notice that the only difference between AIC and BIC is the
multiplier of <em>p</em>, the number of parameters.</p>
<p>Each of the information criteria is used in a similar way — in
comparing two models, the model with the lower value is preferred. The
‘raw’ values have little physical meaning. For now, know that the lower
the AIC, the “better” the model.</p>
<p>Let’s compare two models now, using our transformed data:</p>
<pre class="r"><code>model                 &lt;- lm(Sepal.Length~Sepal.Width,data=iris)
model.transformation  &lt;- lm(Sepal.Length~sqrt(Sepal.Width),data=iris)

model1summary &lt;- summary(model)
model2summary &lt;- summary(model.transformation)

# Adjusted R2
paste(&quot;Model 1:&quot;,round(model1summary$adj.r.squared,2) )</code></pre>
<pre><code>## [1] &quot;Model 1: 0.01&quot;</code></pre>
<pre class="r"><code>paste(&quot;Model 2:&quot;,round(model2summary$adj.r.squared,2) )</code></pre>
<pre><code>## [1] &quot;Model 2: 0.01&quot;</code></pre>
<pre class="r"><code># AIC
AIC(model,model.transformation)</code></pre>
<pre><code>##                      df      AIC
## model                 3 371.9917
## model.transformation  3 372.2743</code></pre>
</div>
</div>
<div id="multiple-regression-model-fitting" class="section level1"
number="2">
<h1><span class="header-section-number">2</span> Multiple regression
&amp; model fitting</h1>
<div id="mlr" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> MLR</h2>
<p>This is very similar to simple regression, but you can add in extra
predictors:</p>
<p>For example, this will predict sepal length, using TWO predictors
(width and petal length). See the MLR lecture for interpretation.</p>
<pre class="r"><code>MLRmodel &lt;- lm(Sepal.Length ~ Sepal.Width + Petal.Length ,data=iris)

ols_regress(MLRmodel)</code></pre>
<pre><code>##                          Model Summary                          
## ---------------------------------------------------------------
## R                       0.917       RMSE                 0.330 
## R-Squared               0.840       MSE                  0.109 
## Adj. R-Squared          0.838       Coef. Var            5.704 
## Pred R-Squared          0.834       AIC                101.025 
## MAE                     0.266       SBC                113.068 
## ---------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
##  AIC: Akaike Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
## 
##                                 ANOVA                                 
## ---------------------------------------------------------------------
##                Sum of                                                
##               Squares         DF    Mean Square       F         Sig. 
## ---------------------------------------------------------------------
## Regression     85.840          2         42.920    386.386    0.0000 
## Residual       16.329        147          0.111                      
## Total         102.168        149                                     
## ---------------------------------------------------------------------
## 
##                                  Parameter Estimates                                   
## --------------------------------------------------------------------------------------
##        model     Beta    Std. Error    Std. Beta      t        Sig     lower    upper 
## --------------------------------------------------------------------------------------
##  (Intercept)    2.249         0.248                  9.070    0.000    1.759    2.739 
##  Sepal.Width    0.596         0.069        0.313     8.590    0.000    0.459    0.733 
## Petal.Length    0.472         0.017        1.006    27.569    0.000    0.438    0.506 
## --------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div id="finding-the-optimal-model" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Finding the “optimal
model”</h1>
<div id="best-subsets" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Best subsets</h2>
<p>There are many models/combinations of predictors that we could use to
predict our response variable. We want to find the best model possible,
but we also don't want to overfit.</p>
<p>So far, we manually compared two models. In fact there is a way to
compare all the combinations of predictors. This is using the
<code>ols_step_best_subset()</code> command.</p>
<p>Describe what the "best subset" method is doing. Hint, we will go
over this in lectures, but also <a
href="https://online.stat.psu.edu/stat501/lesson/10/10.3"
class="uri">https://online.stat.psu.edu/stat501/lesson/10/10.3</a></p>
<p>First, decide every predictor you think might be useful and create a
model using this.</p>
<p>FOR YOUR PROJECT, CHOOSE 8 PREDICTORS MAX (or R takes too long)</p>
<pre class="r"><code>FullModel &lt;- lm(Sepal.Length ~ Sepal.Width + Petal.Length + Petal.Width + Species ,data=iris)


BestSubsets &lt;- ols_step_best_subset(FullModel)
BestSubsets</code></pre>
<p>So now we can find a model that seems to have the lowest AIC, the
highest R2 etc. BUT YOU STILL HAVE TO CHECK FOR LINE!</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
